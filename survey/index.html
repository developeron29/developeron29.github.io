<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
        <link rel="stylesheet" href="./index.css">
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"
        integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
        crossorigin=""/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
        <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"
        integrity="sha512-GffPMF3RvMeYyc1LWMHtK8EbPv0iNZ8/oTtHPx9/cc2ILxQ+u905qIwdpULaqDkyBKgOaB57QTMg7ztg8Jm2Og=="
        crossorigin=""></script>
    </head>
    <body>
        <div class="container">
            <h1>Survey</h1>
            <div>
                <label for="categoryDiv">Category</label>
                <select name="category" id="categoryDiv" class="form-control">
                    <option value="select" disabled selected>Select category</option>
                    <option value="To School">To School</option>
                    <option value="To Work">To Work</option>
                    <option value="To Volunteer">To Volunteer</option>
                    <option value="To gather in Faith/Spiritual Communities">To gather in Faith/Spiritual Communities</option>
                    <option value="To buy groceries, to eat/drink, to shop">To buy groceries, to eat/drink, to shop</option>
                    <option value="For building community">For building community</option>
                    <option value="For healthcare">For healthcare</option>
                    <option value="For Arts">For Arts</option>
                    <option value="For Recreation">For Recreation</option>
                    <option value="Electronic Communities">Electronic Communities</option>
                    <option value="Other">Other</option>
                </select>
                <input type="text" class="otherBox form-control" id="otherBox" placeholder="Enter Other category"/>
                <br>
                <label for="neighourhoodDiv">Neighourhood</label>
                <select name="neighourhood" id="neighourhoodDiv" class="form-control">
                    <option value="select" disabled selected>Select Neighourhood</option>
                    <option value="Belltown">Belltown</option>
                    <option value="Downtown">Downtown</option>
                    <option value="First Hill">First Hill</option>
                    <option value="South Lake Union">South Lake Union</option>
                    <option value="Georgetown">Georgetown</option>
                    <option value="University District">University District</option>
                    <option value="West Seattle">West Seattle</option>
                    <option value="Queen Anne">Queen Anne</option>
                    <option value="Greenlake">Greenlake</option>
                    <option value="Fremont">Fremont</option>
                    <option value="Wallingford">Wallingford</option>
                </select>
                <br>
                <label for="sourceDiv">Source</label>
                <textarea name="source" id="sourceDiv" cols="10" rows="6" placeholder="Enter source" class="form-control"></textarea>
                <br>
                <label for="committeeDiv">Committee</label>
                <select name="committee" id="committeeDiv" class="form-control">
                    <option value="select" disabled selected>Select Committee</option>
                    <option value="WSAC">WSAC</option>
                    <option value="SWAC">SWAC</option>
                    <option value="CDQW">CDQW</option>
                </select>
                <br>
                <label for="location">Where is this location?</label>
                <input type="text" class="form-control" id="autocomplete_search" placeholder="Location">
<br>
                <div id="mapid"></div>
                <br>
                <button class="btn btn-primary">Save My Results?</button>
                <button class="btn btn-danger">Clear Map</button>
            </div>
        </div>
         
        <script>
        var mymap = L.map('mapid').setView([47.649019, -122.347977], 9);

        L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
            maxZoom: 18,
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ',
            id: 'mapbox.streets'
        }).addTo(mymap);

           
            function initialize() {
                var input = document.getElementById('autocomplete_search');
                var options = {
                                types: ['address'],
                                }
                var autocomplete = new google.maps.places.Autocomplete(input, options);
                var seattle = {lat: 47.649019, lng: -122.347977};
                // The map, centered at Uluru
                
                var circle = new google.maps.Circle(
                    {
                        center: seattle,
                        radius: 10
                    }
                );
                autocomplete.setBounds(circle.getBounds());
                autocomplete.addListener('place_changed', function () {
                
                var place = autocomplete.getPlace();
                var coords = [place.geometry.location.lat(), place.geometry.location.lng()];

                var greenIcon = new L.Icon({
                    iconUrl: 'https://marker.nanoka.fr/map_pin-64C81E-FFF-64C81E-%E2%97%89-40.svg',
                    shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
                    iconSize: [25, 41],
                    iconAnchor: [12, 41],
                    popupAnchor: [1, -34],
                    shadowSize: [41, 41]
                    });
                function getIcon() {
                    var e = document.getElementById("categoryDiv");
                    var val = e.options[e.selectedIndex].value;
                    console.log('val', val);
                    var color = '00FFFF';
                    switch(val) {
                        case "To School": 
                            color = '0000FF'
                            break;
                        case "To Work": 
                            color = '7FFF00'
                            break;
                        case "To Volunteer": 
                            color = 'DC143C'
                            break;
                        case "To gather in Faith/Spiritual Communities": 
                            color = 'FF8C00'
                            break;
                        case "To buy groceries, to eat/drink, to shop": 
                            color = 'FF1493'
                            break;
                        case "For building community": 
                            color = 'FF00FF'
                            break;
                        case "For healthcare": 
                            color = 'FFD700'
                            break;
                        case "For Arts": 
                            color = 'ADFF2F'
                            break;
                        case "For Recreation": 
                            color = 'F08080'
                            break;
                        case "Electronic Communities": 
                            color = '20B2AA'
                            break;
                        case "Other": 
                            color = '40E0D0'
                            break;
                        default: 
                            color = '00FFFF';
                            break;
                    } 
                    return new L.Icon({
                    iconUrl: 'https://marker.nanoka.fr/map_pin-' + color + '-FFF-' + color + '-%E2%97%89-40.svg',
                    shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
                    iconSize: [25, 41],
                    iconAnchor: [12, 41],
                    popupAnchor: [1, -34],
                    shadowSize: [41, 41]
                    });
                }
                var marker = L.marker(coords, {icon: getIcon()}).addTo(mymap);
                marker.bindPopup(place.name).openPopup();
                mymap.panTo(coords);
                // mymap.panTo([place.geometry.location.lat, place.geometry.location.lng]);
                // map.setCenter(place.geometry.location);
                // place variable will have all the information you are looking for.
                // $('#lat').val(place.geometry['location'].lat());
                // $('#long').val(place.geometry['location'].lng());
                });
            
           
            // var marker = new google.maps.Marker({position: uluru, map: map});
        }

        // Show and hide other input box, based on chosen category
        $("#otherBox").hide();
        $("#categoryDiv").change(function() {
            var e = document.getElementById("categoryDiv");
            var val = e.options[e.selectedIndex].value;
            if(val.localeCompare("Other") == 0) {
                $("#otherBox").show();
            } else {
                $("#otherBox").hide();
            }
            console.log(val);
        });
        </script>
        <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDaJx13TmDAsFSTGAnRiANwC3U_GXD3VfA&amp;libraries=places&amp;callback=initialize"></script>

    </body>
    
</html>